<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Project Details</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>

<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <a class="navbar-brand" href="#">Project Details</a>
</nav>

<div class="container mt-4">
    <!-- Back to Dashboard Button -->
    <a th:href="@{/adminDashboard}" class="btn btn-secondary mb-3">Back to Dashboard</a>
    <h2 class="text-center">Project Details</h2>

    <!-- Success Message -->
    <div th:if="${successMessage}" class="alert alert-success">
        <p th:text="${successMessage}"></p>
    </div>

    <!-- Error Message -->
    <div th:if="${errorMessage}" class="alert alert-danger">
        <p th:text="${errorMessage}"></p>
    </div>

    <!-- Form to Search for Project by ID -->
    <form th:action="@{/adminDashboard/getProjectById}" method="post">
        <div class="form-group">
            <label>Enter Project ID:</label>
            <div class="input-group">
                <input type="text" name="projectId" class="form-control" required>
                <div class="input-group-append">
                    <button type="submit" class="btn btn-primary">Search</button>
                </div>
            </div>
        </div>
    </form>

    <!-- Project Details Section -->
    <div th:if="${project}">
        <table class="table table-bordered">
            <tr>
                <th>Project ID</th>
                <td th:text="${project.projectId}"></td>
            </tr>
            <tr>
                <th>Project Name</th>
                <td th:text="${project.projectName}"></td>
            </tr>
            <tr>
                <th>Start Date</th>
                <td th:text="${project.startDate}"></td>
            </tr>
            <tr>
                <th>End Date</th>
                <td th:text="${project.endDate}"></td>
                
            </tr>
            <tr th:if="${project.updatedEndDate != null}">
			    <th>Updated End Date</th>
			    <td th:text="${#temporals.format(project.updatedEndDate, 'yyyy-MM-dd')}"></td>
			</tr>
			            
            <tr>
                <th>Client Name</th>
                <td th:text="${project.client.clientName}"></td>
            </tr>
        </table>

        <!-- Buttons: Update, Delete, and Collapsible Details -->
        <div class="mb-3 d-flex align-items-center">
            <a th:href="@{'/adminDashboard/updateProject/' + ${project.projectId}}" class="btn btn-warning mr-2">
                Update Project
            </a>
            <a th:href="@{'/adminDashboard/deleteProject/' + ${project.projectId}}"
               class="btn btn-danger mr-3"
               onclick="return confirm('Are you sure you want to delete this client?');">
                Delete Project
            </a>

            <!-- Collapsible Button -->
            <details class="ml-auto">
                <summary class="btn btn-info">View Client & Employee Details</summary>
                <div class="card card-body mt-3">

                    <!-- Client Details -->
                    <h5>Client Details</h5>
                    <table class="table table-bordered">
                        <tr>
                            <th>Client ID</th>
                            <td th:text="${project.client.clientId}"></td>
                        </tr>
                        <tr>
                            <th>Client Name</th>
                            <td th:text="${project.client.clientName}"></td>
                        </tr>
                    </table>

                    <!-- Employee Details -->
                    <h5>Employee Details</h5>
                    <table class="table table-bordered"
                           th:if="${project.employees != null and not #lists.isEmpty(project.employees)}">
                        <thead>
                            <tr>
                                <th>Employee ID</th>
                                <th>Name</th>
                                <th>Department</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="employee : ${project.employees}">
                                <td th:text="${employee.employeeId}"></td>
                                <td th:text="${employee.name}"></td>
                                <td th:text="${employee.department}"></td>
                            </tr>
                        </tbody>
                    </table>
                    <div th:if="${project.employees == null or #lists.isEmpty(project.employees)}"
                         class="alert alert-warning">
                        No employees assigned to this project.
                    </div>

                </div>
            </details>
        </div>
    </div>
</div>

</body>
</html>
